name: Deploy to LCN via FTP

on:
  workflow_dispatch:

jobs:
  ftp-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v3

      # Optional: test FTP connection with lftp (helps debug auth/port/protocol)
      - name: Test FTP connection (debug)
        run: |
          sudo apt-get update -y
          sudo apt-get install -y lftp
          # replace host/username with secrets; lftp exit code will show success/failure
          lftp -u "${{ secrets.FTP_USERNAME }}","${{ secrets.FTP_PASSWORD }}" "${{ secrets.FTP_HOST }}" -e "ls; bye"
        # If this step fails, the issue is connection/auth/port/firewall

      - name: Upload to LCN via FTP-Deploy-Action
        uses: SamKirkland/FTP-Deploy-Action@v4.3.0
        with:
          server: ${{ secrets.FTP_HOST }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          # only include port if you actually have a non-default port:
          # port: ${{ secrets.FTP_PORT }}
          # If the server requires FTPS, uncomment:
          # protocol: ftps
          local-dir: ./public   # change to your actual build output (e.g., ./dist, ./build)
          server-dir: /public_html
          # exclude: .git*, .github/*   # set exclude patterns according to the action's README
